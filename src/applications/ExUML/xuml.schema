#ruby

require 'core/system/load/load'
require 'core/schema/tools/union'

ss = Load('schema.schema')

connection = Load_text 'schema', ManagedData::Factory.new(ss), <<-PART, true
  class Class
  ! machine: StateMachine?
  end
  class StateMachine
    klass: Class / machine
  end
PART

Union(Factory.new(ss), 
  Load('schema.schema'), 
  Load('state_machine.schema'),
  connection)