

# A is original state
# compute diffs for both new states Ai
D1 = Diff(A, A1)
D2 = Diff(A, A2)

# ask the user to reconcile changes, 
# choosing one operation for any operations in conflict
X = Reconcile(D1, D2)

# inverse any changes that are not used
# (may involve needing to copy results from one to the other)
R1' = RevertNotChosen(X, D1)
R2' = RevertNotChosen(X, D2)

# apply changes from other side, which have not been performed
C1 = D1' + Subtract(X, D1)
C2 = D2' + Subtract(X, D2)
