

def main {
  hello_world("William");
}

def html(title) {
  <html>
    <head><title>$title</title></head>
    <body>yield</body>
  </html>
}

def hello_world(name) {
  html("Test") {
    <h1> "Hello World " $name </h1>
    navigate("Hello World!", hello_world("Tijs"));

    form() {
      <ul>
      for (x: root->classes, i) {
        <li>$i ": " edit(x->name);

        </li>
      }
      </ul>

      submit("Submit", hello_world(name));
    }

 }
}

def navigate(title, page) {
  <a href=link(page)>$title</a>
}

def edit(data) {
  <input name=address(data) type="text" value=data/>
}

def form {
  <form action="/$submit" method="post">
    yield
  </form>
}

def submit(text, action) {
  let
    name = gensym
  in {
    <input type="hidden" name="redirect_" + name value=link(action)/>
    <input type="submit" name=name value=text /> 
  }
}